<client:ToolPanelControl
    SnapsToDevicePixels="True"
    UseLayoutRounding="True"
    d:DesignHeight="450"
    d:DesignWidth="800"
    mc:Ignorable="d"
    x:Class="IRExplorerUI.Profile.CallTreeNodePanel"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:client="clr-namespace:IRExplorerUI"
    xmlns:controls="clr-namespace:IRExplorerUI.Controls"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:doc="clr-namespace:IRExplorerUI.Document"
    xmlns:local="clr-namespace:IRExplorerUI.Controls"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:profile="clr-namespace:IRExplorerUI.Profile"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <Grid Background="{DynamicResource {x:Static SystemColors.ControlLightBrushKey}}" HorizontalAlignment="Stretch">
        <StackPanel
            HorizontalAlignment="Stretch"
            Margin="2"
            VerticalAlignment="Top">
            <StackPanel Orientation="Horizontal">
                <TextBlock
                    Text="Time (total)"
                    VerticalAlignment="Center"
                    Width="70" />

                <ContentControl
                    Content="{Binding Node}"
                    ContentTemplate="{StaticResource ProfilePercentageTemplate}"
                    HorizontalAlignment="Stretch"
                    MinWidth="150" />
            </StackPanel>
            <StackPanel Orientation="Horizontal">
                <TextBlock Text="Time (self)" Width="70" />
                <ContentControl
                    Content="{Binding Node}"
                    ContentTemplate="{StaticResource ProfileExclusivePercentageTemplate}"
                    HorizontalAlignment="Stretch"
                    MinWidth="150" />
            </StackPanel>
        </StackPanel>

        <TabControl
            Background="{DynamicResource {x:Static SystemColors.ControlLightBrushKey}}"
            HorizontalAlignment="Stretch"
            Margin="0,40,0,0"
            Padding="2"
            Visibility="{Binding ShowDetails, Converter={StaticResource BoolToVisibilityConverter}}">
            <TabItem
                Header="Info"
                HorizontalAlignment="Stretch"
                HorizontalContentAlignment="Stretch"
                VerticalAlignment="Stretch">
                <ScrollViewer
                    HorizontalAlignment="Stretch"
                    HorizontalScrollBarVisibility="Disabled"
                    VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="0,4,0,0" MaxWidth="{Binding ActualWidth, ElementName=ContentHost}">
                        <StackPanel Margin="4,2,0,0" Orientation="Horizontal">
                            <TextBlock
                                FontWeight="Medium"
                                Text="Instances"
                                Width="70" />
                            <TextBlock
                                FontWeight="Medium"
                                Margin="4,0,0,0"
                                Text="{Binding FunctionInstancesCount}" />
                        </StackPanel>

                        <StackPanel Margin="4,2,0,0" Orientation="Horizontal">
                            <TextBlock Text="Total time" Width="70" />
                            <ContentControl
                                Content="{Binding InstancesNode}"
                                ContentTemplate="{StaticResource ProfileCombinedPercentageTemplate}"
                                HorizontalAlignment="Left"
                                Margin="4,0,0,0"
                                Width="200" />
                        </StackPanel>

                        <StackPanel Margin="4,2,0,0" Orientation="Horizontal">
                            <TextBlock Text="Median time" Width="70" />
                            <ContentControl
                                Content="{Binding MedianNode}"
                                ContentTemplate="{StaticResource ProfileCombinedPercentageTemplate}"
                                HorizontalAlignment="Left"
                                Margin="4,0,0,0"
                                Width="200" />
                        </StackPanel>


                        <TextBlock
                            FontWeight="Medium"
                            HorizontalAlignment="Left"
                            Margin="4,12,0,0"
                            Text="Module" />
                        <TextBox
                            Background="{x:Null}"
                            BorderBrush="{x:Null}"
                            HorizontalAlignment="Stretch"
                            IsReadOnly="True"
                            MaxLines="3"
                            ScrollViewer.CanContentScroll="True"
                            ScrollViewer.HorizontalScrollBarVisibility="Auto"
                            ScrollViewer.VerticalScrollBarVisibility="Auto"
                            Text="{Binding Path=Node.ModuleName}"
                            TextWrapping="Wrap" />

                        <TextBlock
                            FontWeight="Medium"
                            HorizontalAlignment="Left"
                            Margin="4,4,0,0"
                            Text="Function name" />
                        <TextBox
                            Background="{x:Null}"
                            BorderBrush="{x:Null}"
                            HorizontalAlignment="Stretch"
                            IsReadOnly="True"
                            ScrollViewer.CanContentScroll="True"
                            ScrollViewer.HorizontalScrollBarVisibility="Auto"
                            ScrollViewer.VerticalScrollBarVisibility="Auto"
                            Text="{Binding Path=Node.FullFunctionName}"
                            TextWrapping="Wrap" />
                    </StackPanel>
                </ScrollViewer>
            </TabItem>
            <TabItem
                Header="Backtrace"
                HorizontalAlignment="Stretch"
                ToolTip="Reverse call stack for selected function"
                VerticalAlignment="Stretch">
                <profile:ProfileListView
                    NameColumnTitle="Function"
                    ShowModuleColumn="True"
                    TimeColumnTitle="Time"
                    x:Name="BacktraceList" />
            </TabItem>

            <TabItem
                Header="Functions"
                HorizontalAlignment="Stretch"
                ToolTip="Self time for functions under this instance"
                VerticalAlignment="Stretch">
                <profile:ProfileListView
                    NameColumnTitle="Function"
                    ShowModuleColumn="True"
                    TimeColumnTitle="Time"
                    x:Name="FunctionList" />
            </TabItem>
            <TabItem
                Header="Modules"
                HorizontalAlignment="Stretch"
                ToolTip="Self time for modules under this instance"
                VerticalAlignment="Stretch">
                <profile:ProfileListView
                    ExclusiveTimeColumnTitle="Time"
                    NameColumnTitle="Module"
                    x:Name="ModuleList" />
            </TabItem>

            <TabItem
                Header="Instances"
                HorizontalAlignment="Stretch"
                ToolTip="All unique instances of this function"
                VerticalAlignment="Stretch">
                <profile:ProfileListView
                    NameColumnTitle="Function"
                    TimeColumnTitle="Time"
                    x:Name="InstancesList" />
            </TabItem>
        </TabControl>
    </Grid>
</client:ToolPanelControl>